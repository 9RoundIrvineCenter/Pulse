<!DOCTYPE html>
<html>
<head>
  <title>9Round Irvine Center Pulse Challenge</title>
  <link rel="stylesheet" type="text/css" href="styles.css"> <!-- Make sure this path is correct -->
</head>
<body>
  <!-- Embed the iframe with the Google Sheet -->
  <iframe id="sheetFrame" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRQ2ZHMxBUYYGkZ2z59Kqd94GumA60KdJ4WkzE3ysHfNgmpyrI5vyGM633foL3cJr_YNOUFJ-bPU_Kd/pubhtml?gid=1683515524&single=true&widget=false&headers=false&chrome=false" frameborder="0"></iframe>

  <div id="top-bar"></div>  <!-- Added for demonstration, adjust as needed -->
  <div id="bottom-overlay"></div>

    <script>
  // Function to check if the current time is between 7 AM and 11 PM
  function isWithinRefreshHours() {
    const now = new Date();
    const hours = now.getHours();
    return hours >= 7 && hours < 23;
  }

  // Function to refresh only the iframe content
  function refreshIframe() {
    const now = new Date();
    if (isWithinRefreshHours()) {
      console.log("Refreshing iframe at:", now.toLocaleTimeString());
      var iframe = document.getElementById('sheetFrame');
      var timestamp = now.getTime();
      iframe.src = iframe.src.split('?')[0] + '?gid=1683515524&single=true&widget=true&headers=false&chrome=false&t=' + timestamp;
    
      // Optional: Add a slight delay before refreshing
      setTimeout(function() {
        iframe.src = iframe.src;
      }, 100); // 100ms delay
    } else {
      console.log("Outside refresh hours, skipping refresh.");
    }
  }

  // Use setInterval to check and refresh every 45 seconds
  setInterval(refreshIframe, 45000);

  // Initial check and refresh if within hours
  refreshIframe();

  // Set the background color to black when the DOM content is loaded
    document.addEventListener('DOMContentLoaded', function() {
      document.body.style.backgroundColor = 'black';
      document.documentElement.style.backgroundColor = 'black';
    });
  </script>


</body>
</html>
