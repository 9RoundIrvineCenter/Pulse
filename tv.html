<!DOCTYPE html>
<html>
<head>
  <title>9Round Irvine Center Pulse Challenge</title>
  <link rel="stylesheet" type="text/css" href="styles.css"> <!-- Make sure this path is correct -->
</head>
<body>
  <!-- Embed the iframe with the Google Sheet -->
  <iframe id="sheetFrame" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRQ2ZHMxBUYYGkZ2z59Kqd94GumA60KdJ4WkzE3ysHfNgmpyrI5vyGM633foL3cJr_YNOUFJ-bPU_Kd/pubhtml?gid=1683515524&single=true&widget=false&headers=false&chrome=false"></iframe>

  <div id="top-bar"></div> <!-- Added for demonstration, adjust as needed -->

  <script>
  // Function to check if the current time is between 7 AM and 11 PM
  function isWithinRefreshHours() {
    const now = new Date();
    const hours = now.getHours();
    // Check if hours are between 7 AM (7) and 11 PM (23)
    return hours >= 7 && hours < 23;
  }

  // Function to refresh only the iframe content
  function refreshIframe() {
    const now = new Date();
    if (isWithinRefreshHours()) {
      console.log("Refreshing iframe at:", now.toLocaleTimeString());
      var iframe = document.getElementById('sheetFrame');
      var timestamp = now.getTime();
      iframe.src = iframe.src.split('?')[0] + '?t=' + timestamp;
    } else {
      console.log("Outside refresh hours, skipping refresh.");
    }
  }

  // Use setInterval to check and refresh every 45 seconds
  setInterval(refreshIframe, 45000);

  // Initial check and refresh if within hours
  refreshIframe();
  </script>

</body>
</html>
